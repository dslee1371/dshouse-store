<h2>신규 상품 등록</h2>
<form class="form" method="POST" action="/admin/new" enctype="multipart/form-data">
  <label>상품명<input type="text" name="title" required /></label>
  <label>가격(원)<input type="number" name="price" min="0" step="100" required /></label>
  <label>재고(옵션 미사용 시)<input type="number" name="stock" min="0" step="1" value="0" /></label>
  <label>상품 설명<textarea name="description" rows="5" placeholder="상세 설명"></textarea></label>
  <label>상품 이미지들 (여러 장 선택 가능)
    <input type="file" name="images" accept="image/*" multiple required />
  </label>

  <div class="variant-builder">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
      <div style="font-weight:800">옵션(사이즈/색상)과 재고</div>
      <button type="button" class="btn small ghost" id="addRow">옵션 추가</button>
    </div>
    <div id="variantRows" class="variant-rows">
      <div class="variant-row">
        <input name="opt_size[]" placeholder="사이즈 (예: 90)" />
        <input name="opt_color[]" placeholder="색상 (예: 베이지)" />
        <input name="opt_stock[]" type="number" min="0" step="1" placeholder="재고" />
        <button type="button" class="btn small ghost remove">삭제</button>
      </div>
    </div>
    <p class="muted" style="margin:8px 0 0">※ 옵션을 하나도 입력하지 않으면 위의 "재고"(단일 상품)로 취급합니다.</p>
  </div>

  <button class="btn" type="submit">등록</button>
</form>

<script>
  (function(){
    const rows = document.getElementById('variantRows');
    document.getElementById('addRow').addEventListener('click', () => addRow());
    rows.addEventListener('click', (e) => {
      if (e.target.classList.contains('remove')) {
        const row = e.target.closest('.variant-row');
        if (rows.children.length > 1) row.remove();
      }
    });
    function addRow(){
      const div = document.createElement('div');
      div.className = 'variant-row';
      div.innerHTML = `
        <input name="opt_size[]" placeholder="사이즈 (예: 100)" />
        <input name="opt_color[]" placeholder="색상 (예: 블루)" />
        <input name="opt_stock[]" type="number" min="0" step="1" placeholder="재고" />
        <button type="button" class="btn small ghost remove">삭제</button>
      `;
      rows.appendChild(div);
    }
  })();
</script>